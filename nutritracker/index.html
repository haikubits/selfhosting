import React, { useState, useEffect } from 'react';
import { 
  ChevronLeft, 
  ChevronRight, 
  Plus, 
  Trash2, 
  Settings, 
  Download, 
  Upload, 
  Dumbbell,
  Utensils,
  Flame,
  X,
  Calculator
} from 'lucide-react';

/**
 * UTILITY FUNCTIONS
 */
const generateId = () => Math.random().toString(36).substr(2, 9);

const getDaysInMonth = (year, month) => new Date(year, month + 1, 0).getDate();
const getFirstDayOfMonth = (year, month) => new Date(year, month, 1).getDay();

const formatDateKey = (date) => {
  const d = new Date(date);
  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
};

const formatDisplayDate = (dateString) => {
  if (!dateString) return '';
  const [y, m, d] = dateString.split('-').map(Number);
  return new Date(y, m - 1, d).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });
};

// Default BMR based on user conversation (Male, 31, 5'2", 70kg)
const DEFAULT_BMR = 1535; 

// Mifflin-St Jeor Equation
const calculateBMR = (gender, weight, height, age) => {
  if (!weight || !height || !age) return 0;
  // Formula: (10 × weight in kg) + (6.25 × height in cm) - (5 × age in years) + s
  // s is +5 for males and -161 for females
  const s = gender === 'male' ? 5 : -161;
  const result = (10 * Number(weight)) + (6.25 * Number(height)) - (5 * Number(age)) + s;
  return Math.round(result);
};

/**
 * MAIN COMPONENT
 */
export default function App() {
  // --- STATE ---
  const [currentDate, setCurrentDate] = useState(new Date());
  const [selectedDateKey, setSelectedDateKey] = useState(null);
  const [data, setData] = useState({});
  const [userSettings, setUserSettings] = useState({ 
    bmr: DEFAULT_BMR,
    gender: 'male',
    age: 31,
    weight: 70, // kg
    height: 157 // cm (5'2")
  });
  const [isSettingsOpen, setIsSettingsOpen] = useState(false);
  
  // --- PERSISTENCE ---
  useEffect(() => {
    const savedData = localStorage.getItem('nutritrack_data');
    const savedSettings = localStorage.getItem('nutritrack_settings');
    if (savedData) setData(JSON.parse(savedData));
    if (savedSettings) {
      // Merge saved settings with default structure to ensure new fields exist
      setUserSettings(prev => ({ ...prev, ...JSON.parse(savedSettings) }));
    }
  }, []);

  useEffect(() => {
    localStorage.setItem('nutritrack_data', JSON.stringify(data));
    localStorage.setItem('nutritrack_settings', JSON.stringify(userSettings));
  }, [data, userSettings]);

  // --- HANDLERS ---
  const handlePrevMonth = () => {
    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1));
  };

  const handleNextMonth = () => {
    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1));
  };

  const jumpToToday = () => {
    const now = new Date();
    setCurrentDate(now);
    setSelectedDateKey(formatDateKey(now));
  };

  const handleExport = () => {
    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify({ data, userSettings }));
    const downloadAnchorNode = document.createElement('a');
    downloadAnchorNode.setAttribute("href", dataStr);
    downloadAnchorNode.setAttribute("download", "nutritrack_backup.json");
    document.body.appendChild(downloadAnchorNode);
    downloadAnchorNode.click();
    downloadAnchorNode.remove();
  };

  const handleImport = (event) => {
    const fileReader = new FileReader();
    fileReader.readAsText(event.target.files[0], "UTF-8");
    fileReader.onload = e => {
      const parsed = JSON.parse(e.target.result);
      if (parsed.data) setData(parsed.data);
      if (parsed.userSettings) setUserSettings(prev => ({ ...prev, ...parsed.userSettings }));
    };
  };

  const handleAutoCalculateBMR = () => {
    const calculated = calculateBMR(
      userSettings.gender, 
      userSettings.weight, 
      userSettings.height, 
      userSettings.age
    );
    if (calculated > 0) {
      setUserSettings(prev => ({ ...prev, bmr: calculated }));
    }
  };

  // --- DATA MODIFICATION ---
  const updateEntry = (dateKey, section, items) => {
    setData(prev => ({
      ...prev,
      [dateKey]: {
        ...prev[dateKey],
        [section]: items
      }
    }));
  };

  // --- RENDERING HELPERS ---
  const getDayData = (day) => {
    const dateKey = formatDateKey(new Date(currentDate.getFullYear(), currentDate.getMonth(), day));
    const dayData = data[dateKey] || { foods: [], exercises: [] };
    
    const totalCaloriesIn = dayData.foods?.reduce((acc, curr) => acc + (Number(curr.calories) || 0), 0) || 0;
    const totalProtein = dayData.foods?.reduce((acc, curr) => acc + (Number(curr.protein) || 0), 0) || 0;
    const exerciseBurn = dayData.exercises?.reduce((acc, curr) => acc + (Number(curr.calories) || 0), 0) || 0;
    
    return { dateKey, totalCaloriesIn, totalProtein, exerciseBurn };
  };

  const renderCalendar = () => {
    const daysInMonth = getDaysInMonth(currentDate.getFullYear(), currentDate.getMonth());
    const firstDay = getFirstDayOfMonth(currentDate.getFullYear(), currentDate.getMonth());
    const days = [];

    // Empty slots for previous month
    for (let i = 0; i < firstDay; i++) {
      days.push(<div key={`empty-${i}`} className="h-32 bg-gray-900/30 border border-gray-800/50"></div>);
    }

    // Actual days
    for (let d = 1; d <= daysInMonth; d++) {
      const { dateKey, totalCaloriesIn, totalProtein, exerciseBurn } = getDayData(d);
      const isToday = formatDateKey(new Date()) === dateKey;
      const totalSpent = Number(userSettings.bmr) + exerciseBurn;
      const net = totalCaloriesIn - totalSpent;

      days.push(
        <div 
          key={dateKey}
          onClick={() => setSelectedDateKey(dateKey)}
          className={`h-32 p-2 border border-gray-800 bg-gray-900 hover:bg-gray-800 transition-colors cursor-pointer flex flex-col justify-between relative group ${isToday ? 'ring-1 ring-blue-500' : ''}`}
        >
          <div className="flex justify-between items-start">
            <span className={`text-sm font-medium ${isToday ? 'text-blue-400' : 'text-gray-400'}`}>{d}</span>
            {totalCaloriesIn > 0 && (
              <span className={`text-xs px-1.5 rounded ${net > 0 ? 'bg-red-900/30 text-red-400' : 'bg-green-900/30 text-green-400'}`}>
                {net > 0 ? '+' : ''}{Math.round(net)}
              </span>
            )}
          </div>

          <div className="space-y-1 mt-1">
            {totalCaloriesIn > 0 && (
              <div className="flex items-center text-xs text-emerald-400">
                <Utensils size={10} className="mr-1" />
                {Math.round(totalCaloriesIn)} cal
              </div>
            )}
            {totalProtein > 0 && (
              <div className="flex items-center text-xs text-blue-400">
                <span className="font-bold text-[10px] mr-1">P</span>
                {Math.round(totalProtein)}g
              </div>
            )}
            <div className="flex items-center text-xs text-orange-400">
              <Flame size={10} className="mr-1" />
              {Math.round(totalSpent)} out
            </div>
          </div>
        </div>
      );
    }

    return days;
  };

  return (
    <div className="min-h-screen bg-gray-950 text-gray-100 font-sans selection:bg-blue-500/30">
      
      {/* HEADER */}
      <header className="border-b border-gray-800 p-4 sticky top-0 bg-gray-950/95 backdrop-blur z-10">
        <div className="max-w-6xl mx-auto flex items-center justify-between">
          <div className="flex items-center gap-4">
            <h1 className="text-xl font-bold tracking-tight text-white flex items-center gap-2">
              <div className="w-8 h-8 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center">
                <Utensils size={16} className="text-white" />
              </div>
              NutriTrack
            </h1>
            <div className="hidden md:flex items-center gap-1 bg-gray-900 rounded-lg p-1 border border-gray-800">
              <button onClick={handlePrevMonth} className="p-1 hover:bg-gray-800 rounded"><ChevronLeft size={20} /></button>
              <span className="px-3 font-medium min-w-[140px] text-center">
                {currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
              </span>
              <button onClick={handleNextMonth} className="p-1 hover:bg-gray-800 rounded"><ChevronRight size={20} /></button>
            </div>
          </div>

          <div className="flex items-center gap-3">
             <button onClick={jumpToToday} className="px-3 py-1.5 text-sm bg-blue-600 hover:bg-blue-500 text-white rounded-md transition-colors">
              Today
            </button>
            <button onClick={() => setIsSettingsOpen(true)} className="p-2 hover:bg-gray-800 rounded-md text-gray-400 hover:text-white transition-colors">
              <Settings size={20} />
            </button>
          </div>
        </div>
      </header>

      {/* CALENDAR GRID */}
      <main className="max-w-6xl mx-auto p-4">
        {/* Mobile Nav */}
        <div className="md:hidden flex justify-between items-center mb-4 text-lg font-medium">
           <button onClick={handlePrevMonth}><ChevronLeft /></button>
           <span>{currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</span>
           <button onClick={handleNextMonth}><ChevronRight /></button>
        </div>

        <div className="grid grid-cols-7 gap-px bg-gray-800 border border-gray-800 rounded-lg overflow-hidden shadow-2xl">
          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
            <div key={day} className="bg-gray-900 p-2 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">
              {day}
            </div>
          ))}
          {renderCalendar()}
        </div>

        <div className="mt-8 text-center text-sm text-gray-500">
          <p>Click on any date to log meals and workouts.</p>
        </div>
      </main>

      {/* MODAL - DAY LOG */}
      {selectedDateKey && (
        <DayModal 
          dateKey={selectedDateKey}
          data={data[selectedDateKey]} 
          onClose={() => setSelectedDateKey(null)}
          onUpdate={(section, items) => updateEntry(selectedDateKey, section, items)}
          bmr={userSettings.bmr}
        />
      )}

      {/* SETTINGS MODAL */}
      {isSettingsOpen && (
        <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-gray-900 border border-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6 animate-in fade-in zoom-in duration-200">
            <div className="flex justify-between items-center mb-6">
              <h2 className="text-xl font-bold flex items-center gap-2"><Settings size={20}/> Settings</h2>
              <button onClick={() => setIsSettingsOpen(false)}><X className="text-gray-400 hover:text-white" /></button>
            </div>
            
            <div className="space-y-6 overflow-y-auto max-h-[70vh] pr-2">
              
              {/* Profile Stats Section */}
              <div className="bg-gray-800/30 p-4 rounded-lg border border-gray-800">
                <h3 className="text-sm font-semibold text-blue-400 mb-4 flex items-center gap-2">
                  <Calculator size={16}/> Calculate BMR
                </h3>
                
                <div className="grid grid-cols-2 gap-4 mb-4">
                  <div>
                    <label className="block text-xs font-medium text-gray-400 mb-1">Gender</label>
                    <select 
                      value={userSettings.gender}
                      onChange={(e) => setUserSettings({...userSettings, gender: e.target.value})}
                      className="w-full bg-gray-950 border border-gray-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none"
                    >
                      <option value="male">Male</option>
                      <option value="female">Female</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-xs font-medium text-gray-400 mb-1">Age</label>
                    <input 
                      type="number" 
                      value={userSettings.age}
                      onChange={(e) => setUserSettings({...userSettings, age: e.target.value})}
                      className="w-full bg-gray-950 border border-gray-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                  </div>
                  <div>
                    <label className="block text-xs font-medium text-gray-400 mb-1">Weight (kg)</label>
                    <input 
                      type="number" 
                      value={userSettings.weight}
                      onChange={(e) => setUserSettings({...userSettings, weight: e.target.value})}
                      className="w-full bg-gray-950 border border-gray-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                  </div>
                  <div>
                    <label className="block text-xs font-medium text-gray-400 mb-1">Height (cm)</label>
                    <input 
                      type="number" 
                      value={userSettings.height}
                      onChange={(e) => setUserSettings({...userSettings, height: e.target.value})}
                      className="w-full bg-gray-950 border border-gray-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                  </div>
                </div>

                <button 
                  onClick={handleAutoCalculateBMR}
                  className="w-full py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-md text-sm font-medium transition-colors mb-3"
                >
                  Calculate & Update BMR
                </button>
                <p className="text-xs text-gray-500 text-center">
                  Uses the Mifflin-St Jeor equation.
                </p>
              </div>

              {/* BMR Result Section */}
              <div>
                <label className="block text-sm font-medium text-gray-400 mb-1">Base Metabolic Rate (BMR)</label>
                <div className="flex gap-2">
                   <input 
                    type="number" 
                    value={userSettings.bmr}
                    onChange={(e) => setUserSettings({...userSettings, bmr: Number(e.target.value)})}
                    className="flex-1 bg-gray-950 border border-gray-700 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none font-mono text-lg text-orange-400"
                  />
                  <div className="px-3 py-2 bg-gray-800 rounded-md text-sm text-gray-400 flex items-center">cal/day</div>
                </div>
                <p className="text-xs text-gray-500 mt-2">
                  This value is used to calculate your "Total Spent" calories each day.
                </p>
              </div>

              <div className="pt-6 border-t border-gray-800">
                <h3 className="text-sm font-medium text-gray-400 mb-3">Data Management</h3>
                <div className="flex gap-3">
                  <button onClick={handleExport} className="flex-1 flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-sm py-2 rounded-md transition-colors">
                    <Download size={16} /> Export JSON
                  </button>
                  <label className="flex-1 flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 text-sm py-2 rounded-md transition-colors cursor-pointer">
                    <Upload size={16} /> Import JSON
                    <input type="file" accept=".json" onChange={handleImport} className="hidden" />
                  </label>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

/**
 * DAY DETAILS MODAL
 */
function DayModal({ dateKey, data, onClose, onUpdate, bmr }) {
  const foods = data?.foods || [];
  const exercises = data?.exercises || [];

  const handleAddFood = () => {
    onUpdate('foods', [...foods, { id: generateId(), name: '', calories: '', protein: '' }]);
  };

  const handleAddExercise = () => {
    onUpdate('exercises', [...exercises, { id: generateId(), type: 'strength', name: '', sets: '', reps: '', duration: '', calories: '' }]);
  };

  const handleUpdateItem = (section, id, field, value) => {
    const list = section === 'foods' ? foods : exercises;
    const updated = list.map(item => item.id === id ? { ...item, [field]: value } : item);
    onUpdate(section, updated);
  };

  const handleDeleteItem = (section, id) => {
    const list = section === 'foods' ? foods : exercises;
    onUpdate(section, list.filter(item => item.id !== id));
  };

  // Calculations
  const totalFoodCals = foods.reduce((acc, curr) => acc + (Number(curr.calories) || 0), 0);
  const totalProtein = foods.reduce((acc, curr) => acc + (Number(curr.protein) || 0), 0);
  const exerciseBurn = exercises.reduce((acc, curr) => acc + (Number(curr.calories) || 0), 0);
  const totalSpent = Number(bmr) + exerciseBurn;

  return (
    <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-40 flex items-center justify-center p-2 md:p-6 overflow-hidden">
      <div className="bg-gray-900 border border-gray-800 rounded-xl shadow-2xl w-full max-w-4xl h-full md:h-auto md:max-h-[90vh] flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-200">
        
        {/* Modal Header */}
        <div className="flex justify-between items-center p-6 border-b border-gray-800">
          <div>
            <h2 className="text-2xl font-bold text-white">{formatDisplayDate(dateKey)}</h2>
            <p className="text-sm text-gray-400">Daily Log</p>
          </div>
          <button onClick={onClose} className="p-2 hover:bg-gray-800 rounded-full transition-colors">
            <X size={24} />
          </button>
        </div>

        {/* Modal Body - Scrollable */}
        <div className="flex-1 overflow-y-auto p-6 space-y-8">
          
          {/* FOOD SECTION */}
          <section>
            <div className="flex justify-between items-center mb-4">
              <h3 className="text-lg font-semibold text-emerald-400 flex items-center gap-2">
                <Utensils size={20} /> Food Intake
              </h3>
              <button onClick={handleAddFood} className="flex items-center gap-1 text-xs bg-emerald-900/30 hover:bg-emerald-900/50 text-emerald-400 px-2 py-1 rounded border border-emerald-900/50 transition-colors">
                <Plus size={14} /> Add Food
              </button>
            </div>
            
            <div className="bg-gray-950/50 rounded-lg border border-gray-800 overflow-hidden">
              <table className="w-full text-left text-sm">
                <thead className="bg-gray-800/50 text-gray-400">
                  <tr>
                    <th className="p-3 font-medium w-1/2">Item Name</th>
                    <th className="p-3 font-medium w-24">Calories</th>
                    <th className="p-3 font-medium w-24">Protein (g)</th>
                    <th className="p-3 w-10"></th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-800">
                  {foods.length === 0 && (
                    <tr><td colSpan="4" className="p-8 text-center text-gray-600 italic">No food logged yet.</td></tr>
                  )}
                  {foods.map(item => (
                    <tr key={item.id} className="group hover:bg-gray-800/30">
                      <td className="p-2">
                        <input 
                          type="text" 
                          placeholder="e.g. Paneer" 
                          value={item.name}
                          onChange={(e) => handleUpdateItem('foods', item.id, 'name', e.target.value)}
                          className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                        />
                      </td>
                      <td className="p-2">
                        <input 
                          type="number" 
                          placeholder="0" 
                          value={item.calories}
                          onChange={(e) => handleUpdateItem('foods', item.id, 'calories', e.target.value)}
                          className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                        />
                      </td>
                      <td className="p-2">
                        <input 
                          type="number" 
                          placeholder="0" 
                          value={item.protein}
                          onChange={(e) => handleUpdateItem('foods', item.id, 'protein', e.target.value)}
                          className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                        />
                      </td>
                      <td className="p-2 text-right">
                        <button onClick={() => handleDeleteItem('foods', item.id)} className="text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all">
                          <Trash2 size={16} />
                        </button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </section>

          {/* EXERCISE SECTION */}
          <section>
            <div className="flex justify-between items-center mb-4">
              <h3 className="text-lg font-semibold text-orange-400 flex items-center gap-2">
                <Dumbbell size={20} /> Exercise & Activity
              </h3>
              <button onClick={handleAddExercise} className="flex items-center gap-1 text-xs bg-orange-900/30 hover:bg-orange-900/50 text-orange-400 px-2 py-1 rounded border border-orange-900/50 transition-colors">
                <Plus size={14} /> Add Exercise
              </button>
            </div>

            <div className="bg-gray-950/50 rounded-lg border border-gray-800 overflow-hidden">
              <table className="w-full text-left text-sm">
                <thead className="bg-gray-800/50 text-gray-400">
                  <tr>
                    <th className="p-3 font-medium w-24">Type</th>
                    <th className="p-3 font-medium">Description</th>
                    <th className="p-3 font-medium w-20">Sets</th>
                    <th className="p-3 font-medium w-20">Reps</th>
                    <th className="p-3 font-medium w-24">Dur (min)</th>
                    <th className="p-3 font-medium w-24">Burn (cal)</th>
                    <th className="p-3 w-10"></th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-800">
                  {exercises.length === 0 && (
                    <tr><td colSpan="7" className="p-8 text-center text-gray-600 italic">No exercise logged yet.</td></tr>
                  )}
                  {exercises.map(item => (
                    <tr key={item.id} className="group hover:bg-gray-800/30">
                      <td className="p-2">
                        <select 
                          value={item.type}
                          onChange={(e) => handleUpdateItem('exercises', item.id, 'type', e.target.value)}
                          className="bg-gray-900 border border-gray-700 rounded text-xs py-1 px-2 outline-none focus:border-blue-500"
                        >
                          <option value="strength">Strength</option>
                          <option value="cardio">Cardio</option>
                          <option value="warmup">Warmup</option>
                        </select>
                      </td>
                      <td className="p-2">
                         <input 
                          type="text" 
                          placeholder="e.g. Shoulder Press" 
                          value={item.name}
                          onChange={(e) => handleUpdateItem('exercises', item.id, 'name', e.target.value)}
                          className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                        />
                      </td>
                      <td className="p-2">
                        {item.type === 'strength' ? (
                          <input 
                            type="number" 
                            placeholder="-" 
                            value={item.sets}
                            onChange={(e) => handleUpdateItem('exercises', item.id, 'sets', e.target.value)}
                            className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                          />
                        ) : <span className="text-gray-700">-</span>}
                      </td>
                      <td className="p-2">
                        {item.type === 'strength' ? (
                          <input 
                            type="number" 
                            placeholder="-" 
                            value={item.reps}
                            onChange={(e) => handleUpdateItem('exercises', item.id, 'reps', e.target.value)}
                            className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                          />
                        ) : <span className="text-gray-700">-</span>}
                      </td>
                      <td className="p-2">
                         {item.type !== 'strength' ? (
                          <input 
                            type="number" 
                            placeholder="min" 
                            value={item.duration}
                            onChange={(e) => handleUpdateItem('exercises', item.id, 'duration', e.target.value)}
                            className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                          />
                        ) : <span className="text-gray-700">-</span>}
                      </td>
                      <td className="p-2">
                        <input 
                          type="number" 
                          placeholder="0" 
                          value={item.calories}
                          onChange={(e) => handleUpdateItem('exercises', item.id, 'calories', e.target.value)}
                          className="w-full bg-transparent outline-none placeholder-gray-700 text-gray-200"
                        />
                      </td>
                      <td className="p-2 text-right">
                        <button onClick={() => handleDeleteItem('exercises', item.id)} className="text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all">
                          <Trash2 size={16} />
                        </button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </section>

        </div>

        {/* Modal Footer - Summary */}
        <div className="bg-gray-950 p-6 border-t border-gray-800 flex flex-col md:flex-row gap-6 justify-between items-center text-sm md:text-base">
          <div className="flex gap-8">
            <div>
               <span className="block text-gray-500 text-xs uppercase tracking-wider mb-1">Total Intake</span>
               <span className="text-xl font-bold text-white">{totalFoodCals} <span className="text-sm font-normal text-gray-500">kcal</span></span>
            </div>
            <div>
               <span className="block text-gray-500 text-xs uppercase tracking-wider mb-1">Total Protein</span>
               <span className="text-xl font-bold text-blue-400">{totalProtein} <span className="text-sm font-normal text-gray-500">g</span></span>
            </div>
          </div>

          <div className="flex gap-8">
             <div className="text-right">
               <span className="block text-gray-500 text-xs uppercase tracking-wider mb-1">Total Spent (BMR + Burn)</span>
               <span className="text-xl font-bold text-orange-400">{totalSpent} <span className="text-sm font-normal text-gray-500">kcal</span></span>
            </div>
            <div className="text-right pl-6 border-l border-gray-800">
               <span className="block text-gray-500 text-xs uppercase tracking-wider mb-1">Net Calories</span>
               <span className={`text-xl font-bold ${totalFoodCals - totalSpent > 0 ? 'text-red-400' : 'text-green-400'}`}>
                 {totalFoodCals - totalSpent > 0 ? '+' : ''}{totalFoodCals - totalSpent}
               </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
